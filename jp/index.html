<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>【論文ノート】WPD-CNNによる機械システムの極度な不均衡故障診断</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/5.2.0/github-markdown.min.css">
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        body { margin: 0; padding: 0; display: flex; min-height: 100vh; background-color: #fff; font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif; }
        .sidebar { width: 280px; background-color: #f6f8fa; border-right: 1px solid #d0d7de; position: fixed; height: 100vh; overflow-y: auto; padding: 24px; box-sizing: border-box; top: 0; left: 0; z-index: 100; }
        .sidebar h2 { font-size: 16px; font-weight: 600; margin-bottom: 16px; color: #24292f; }
        .sidebar ul { list-style: none; padding: 0; margin: 0; }
        .sidebar li { margin-bottom: 8px; }
        .sidebar a { text-decoration: none; color: #57606a; font-size: 14px; display: block; padding: 4px 0; transition: color 0.2s; }
        .sidebar a:hover { color: #0969da; text-decoration: underline; }
        .sidebar .sub-menu { margin-left: 20px; margin-top: 4px; font-size: 13px; }
        .main-content { margin-left: 280px; flex: 1; padding: 40px 60px; max-width: 1000px; }
        html { scroll-behavior: smooth; }
        div[align="center"] { text-align: center; margin: 20px 0; }
        table { display: block; width: 100%; overflow: auto; }
        @media (max-width: 900px) {
            body { display: block; }
            .sidebar { position: relative; width: 100%; height: auto; border-right: none; border-bottom: 1px solid #d0d7de; }
            .main-content { margin-left: 0; padding: 20px; }
        }
    </style>
</head>
<body>
    <nav class="sidebar">
    <div style="margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px solid var(--border-color); display: flex; gap: 8px; flex-wrap: wrap;">
        <span style="font-size: 0.8rem; color: var(--text-light); width: 100%;">语言 / Language / 言語 / 언어:</span>
        <a href="../zh/index.html" style="color: var(--primary-color); font-weight: bold; font-size: 0.85rem;">中文</a>
        <a href="../en/index.html" style="color: var(--primary-color); font-weight: bold; font-size: 0.85rem;">English</a>
        <a href="../jp/index.html" style="color: var(--primary-color); font-weight: bold; font-size: 0.85rem;">日本語</a>
        <a href="../kr/index.html" style="color: var(--primary-color); font-weight: bold; font-size: 0.85rem;">한국어</a>
    </div>

        
        <h2>目次</h2>
        <ul>
            <li><a href="#1-研究背景">1. 研究背景</a></li>
            <li>
                <a href="#2-技術原理">2. 技術原理：ウェーブレットパケット歪み</a>
                <ul class="sub-menu">
                    <li><a href="#21-信号分解と変換">2.1 信号分解と変換</a></li>
                    <li><a href="#22-非線形歪み処理">2.2 非線形歪み処理</a></li>
                    <li><a href="#23-信号の再構成">2.3 信号の再構成</a></li>
                </ul>
            </li>
            <li><a href="#3-分類モデルアーキテクチャ">3. 分類モデルアーキテクチャ：ConvNet</a></li>
            <li>
                <a href="#4-実験検証">4. 実験検証</a>
                <ul class="sub-menu">
                    <li><a href="#41-実験設定">4.1 実験設定</a></li>
                    <li><a href="#42-性能比較">4.2 性能比較</a></li>
                </ul>
            </li>
            <li><a href="#5-結論">5. 結論</a></li>
            <li><a href="#参考文献">参考文献</a></li>
        </ul>
    </nav>
    <main class="main-content markdown-body">
        <h1>【論文ノート】ウェーブレットパケット歪みと畳み込みニューラルネットワークに基づく機械システムの極度な不均衡故障診断</h1>
        <blockquote>
            <p><strong>Mechanical Fault Diagnosis via WPD-CNN</strong></p>
            <p><strong>Journal:</strong> <em>Advanced Engineering Informatics</em>, Vol. 51, 2022, 101535</p>
            <p><strong>DOI:</strong> <a href="https://doi.org/10.1016/j.aei.2022.101535">10.1016/j.aei.2022.101535</a></p>
        </blockquote>
        <p>
            <a href="https://doi.org/10.1016/j.aei.2022.101535"><img src="https://img.shields.io/badge/DOI-10.1016/j.aei.2022.101535-blue" alt="DOI"></a>
            <a href="#"><img src="https://img.shields.io/badge/Status-Published-brightgreen" alt="Status"></a>
            <a href="#"><img src="https://img.shields.io/badge/Topic-Imbalanced%20Learning-orange" alt="Topic"></a>
        </p>

        <h3 id="1-研究背景">1. 研究背景</h3>
        <p>機械システムの監視において、自動故障診断技術は産業の安全性を確保する上で重要です。しかし、実際のエンジニアリング環境における核心的な課題は<strong>クラスの不均衡（Class Imbalance）</strong>です。機械は長期間正常に動作するため、正常データのサンプルは豊富ですが、実際の故障サンプルは極めて稀です。</p>
        <p>従来の深層学習モデルを極度に不均衡なデータセット（正常と故障の比率が80:1など）で学習させると、分類バイアスが生じ、すべてのサンプルを多数派クラス（正常）と予測する傾向があり、故障の見逃しにつながります。既存のデータ拡張手法（ランダムオーバーサンプリングやSMOTEなど）は、ごく少数の故障サンプルを扱う際に過学習を引き起こしたり、無関係なノイズを混入させる可能性があります。</p>

        <h3 id="2-技術原理">2. 技術原理：ウェーブレットパケット歪み (WPD)</h3>
        <p>本論文では、ウェーブレットパケット歪み（WPD）に基づくデータ拡張戦略を提案し、時間周波数領域で物理的意味を持つ変換を行うことで、多様性のある新しいサンプルを生成します。</p>

        <div align="center">
          <img src="https://github.com/user-attachments/assets/9c1c7353-00f0-4f8d-8ea9-bdf849c986c1" width="70%" />
          <p><em>図1 ウェーブレットパケット歪みのフローチャート</em></p>
        </div>

        <h4 id="21-信号分解と変換">2.1 信号分解と変換</h4>
        <p>この手法では、まずウェーブレットパケット変換（WPT）を使用して、元の振動信号を異なる周波数帯域のウェーブレットパケット係数に分解します。標準的なウェーブレット変換と比較して、WPTはより細かい周波数分解能を提供し、故障特徴をより完全に捉えます。</p>

        <h4 id="22-非線形歪み処理">2.2 非線形歪み処理</h4>
        <p>分解された係数空間において、特定のノードをランダムに選択し、非線形処理を行います。処理関数は次のように定義されます：</p>
        <p>$$ \tilde{w} = \text{sign}(w) \cdot (\text{abs}(w))^d $$</p>
        <p>ここで、wは元の係数、dは事前に設定された範囲（[0.8, 1.2]など）からランダムに選択される歪み係数です。故障特徴は特定の周波数成分と関連しているため、dを調整することで、元の周波数分布特性を保持しつつ、波形の具体的な形状（振幅のディテール）を変化させることができます。</p>

        <div align="center">
          <img src="https://github.com/user-attachments/assets/a743b18c-7fcd-4569-aef5-a411939a02be" width="50%" />
          <p><em>図2 正弦波信号とその歪みバージョン</em></p>
        </div>

        <h4 id="23-信号の再構成">2.3 信号の再構成</h4>
        <p>修正された係数は、逆ウェーブレットパケット変換（Inverse WPT）によって時系列信号に再構成されます。生成されたサンプルを元のサンプルと混合し、クラスのバランスが取れた学習データセットを構築します。</p>

        <h3 id="3-分類モデルアーキテクチャ">3. 分類モデルアーキテクチャ：ConvNet</h3>
        <p>分類器として畳み込みニューラルネットワーク（CNN）を使用しています。WPD拡張後のデータセットはクラスのバランスが取れているため、CNNは異なる状態を区別するための深層特徴を効果的に学習できます。モデルには畳み込み層、バッチ正規化（BN）、ReLU、Global Average Pooling（GAP）が含まれ、Softmax層で結果を出力します。</p>

        <h3 id="4-実験検証">4. 実験検証</h3>

        <h4 id="41-実験設定">4.1 実験設定</h4>
        <p>実験データは、<strong>民間航空機の油圧ポンプ</strong>の地上シミュレーションテストベンチから取得されました。データセットには、1種類の正常状態と5種類の故障状態が含まれています。極度な不均衡をシミュレートするため、各故障クラスから学習用に5サンプルのみを選択し、正常クラスには400サンプルの学習データを用意しました。</p>

        <table>
            <thead>
                <tr>
                    <th align="left">ラベル</th>
                    <th align="left">状態の説明</th>
                    <th align="left">学習サンプル数</th>
                    <th align="left">テストサンプル数</th>
                </tr>
            </thead>
            <tbody>
                <tr><td align="left"><strong>H</strong></td><td align="left">正常稼働状態 (No observable faults)</td><td align="left">400</td><td align="left">80</td></tr>
                <tr><td align="left"><strong>F1</strong></td><td align="left">配油盤の摩耗故障 (Wear-out failure of oil distribution pan)</td><td align="left">5</td><td align="left">475</td></tr>
                <tr><td align="left"><strong>F2</strong></td><td align="left">シリンダーブロックの摩耗故障 (Wear-out failure of cylinder blocks)</td><td align="left">5</td><td align="left">475</td></tr>
                <tr><td align="left"><strong>F3</strong></td><td align="left">低圧入口浸食故障 (Eroding failure with 0.3 Mpa lower entry pressure)</td><td align="left">5</td><td align="left">475</td></tr>
                <tr><td align="left"><strong>F4</strong></td><td align="left">出口圧力異常による変形故障 (Distortion failure with 20 Mpa exit pressure)</td><td align="left">5</td><td align="left">475</td></tr>
                <tr><td align="left"><strong>F5</strong></td><td align="left">0.8 mm 亀裂疲労故障 (Fatigued failure with a chink of 0.8 mm)</td><td align="left">5</td><td align="left">475</td></tr>
            </tbody>
        </table>

        <h4 id="42-性能比較">4.2 性能比較</h4>
        <p>提案手法（Developed）をベースラインConvNet、アンダーサンプリング（DS）、オーバーサンプリング（OS）と比較しました。</p>
        <table>
            <thead>
                <tr>
                    <th align="left">平均指標 (%)</th>
                    <th align="left">ConvNet (ベースライン)</th>
                    <th align="left">DS + ConvNet</th>
                    <th align="left">OS + ConvNet</th>
                    <th align="left"><strong>Developed (提案手法)</strong></th>
                </tr>
            </thead>
            <tbody>
                <tr><td align="left"><strong>F1-score</strong></td><td align="left">89.40 ± 3.40</td><td align="left">92.48 ± 2.95</td><td align="left">96.03 ± 2.65</td><td align="left"><strong>97.50 ± 1.74</strong></td></tr>
                <tr><td align="left"><strong>Precision</strong></td><td align="left">91.10 ± 2.73</td><td align="left">93.40 ± 2.63</td><td align="left">96.66 ± 1.88</td><td align="left"><strong>97.78 ± 1.27</strong></td></tr>
                <tr><td align="left"><strong>Recall</strong></td><td align="left">89.52 ± 3.16</td><td align="left">92.53 ± 2.97</td><td align="left">96.10 ± 2.51</td><td align="left"><strong>97.54 ± 1.65</strong></td></tr>
            </tbody>
        </table>

        <h3 id="5-結論">5. 結論</h3>
        <p>ウェーブレットパケット歪みは、信号レベルでのデータ拡張手法として、機械故障診断における小規模サンプルと不均衡の問題を効果的に緩和できます。計算効率が高く、複雑な生成ネットワークに依存せず、元の物理的特徴を保持するため、民間航空や風力発電などの重要な産業分野における予知保全タスクに適しています。</p>

        <hr>
        <h3 id="参考文献">参考文献</h3>
        <ul>
            <li><strong>タイトル:</strong> Highly imbalanced fault diagnosis of mechanical systems based on wavelet packet distortion and convolutional neural networks</li>
            <li><strong>ジャーナル:</strong> <em>Advanced Engineering Informatics</em>, 2022, 51: 101535.</li>
            <li><strong>DOI:</strong> <a href="https://doi.org/10.1016/j.aei.2022.101535">10.1016/j.aei.2022.101535</a></li>
        </ul>
    </main>
</body>
</html>

